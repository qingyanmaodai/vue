<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>APS总装看板</title>
  <link rel="stylesheet" type="text/css" href="./css/common.css" />
  <link rel="stylesheet" type="text/css" href="./css/WorkShop.css" />
</head>

<body style="padding: 0; margin: 0;">
  <div v-cloak id="app" class="page flex-col">
    <div class="wrap1 flex-col">
      <div class="mod1 flex-col">
        <div class="group43 flex-col">
          <div class="group44 flex-col">
            <div class="box34 flex-row justify-between">
              <span class="info1">{{todayDate}}</span>
            </div>
            <div class="header_title">
              <span class="info2">{{form.OrganizeName}}综合看板</span>
            </div>
            <div class="headRight">
              <span class="img"> <image @click="moreLarge" src="./images/large.png" class="fullScreen"/></span>
            </div>
          </div>
        </div>
        <div class="mainContent flex-col justify-between">
          <div class="group45 flex-row justify-between">
            <div class="main42 flex-col">
              <div class="outer26 flex-row">
                <span class="info34">人员管理</span>
              </div>
              <div class="content  flex-col justify-between align-center">
                <div class="group7 flex-row justify-center">
                  <span class="word1">{{form.TotalPeoples||0}}</span>
                  <span class="word2">{{list[0].unProductionQty?parseFloat(((list[0].unProductionQty/list[0].ProductionQty)*100).toFixed(2)):0}}%</span>
                </div>
                <div class="group8 flex-row ">
                  <div class="main1 flex-col">
                    <span class="word5">组织人数</span>
                  </div>
                  <div class="main2 flex-col">
                    <span class="txt1">出勤率</span>
                  </div>
                </div>
                <div class="group9 flex-row justify-center">
                  <span class="info4">{{list[0].ProductionQty||0}}</span>
                  <span class="word2">{{list[0].unProductionQty||0}}</span>
                </div>
                <div class="group10 flex-row">
                  <div class="layer2 flex-col">
                    <span class="info5">出勤人数</span>
                  </div>
                  <div class="layer3 flex-col">
                    <span class="txt2">未出勤人数</span>
                  </div>
                </div>
                <div class="group11 flex-row justify-center">
                  <span class="info4">{{list[0].ruzhi||0}}</span>
                  <span class="info4">{{list[0].lizhi||0}}</span>
                </div>
                <div class="group12 flex-row">
                  <div class="mod2 flex-col">
                    <span class="word4">总装线体</span>
                  </div>
                  <div class="mod3 flex-col">
                    <span class="info6">丝印线体</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="main43 flex-col justify-between">
              <div class="outer26 flex-row">
                <span class="info34">超期异常原因</span>
              </div>
              <div class="content2">
                <div class="flex-row justify-between">
                  <!-- <span class="txt4">（单位：台）</span> -->
                  <!-- <span class="info7">组装线</span> -->
                </div>
                <div class="navboxall_time" id="PerHourCapOption"></div>
              </div>
            </div>
            <div class="main42 flex-col">
              <div class="outer26 flex-row">
                <span class="info34">本月工单状态</span>
              </div>
              <div class="content  flex-col justify-between align-center">
                <div class="group7 flex-row justify-center">
                  <span class="word1">{{list[2].Qty||0}}</span>
                  <span class="info3">{{list[2].yikaigong||0}}</span>
                </div>
                <div class="group8 flex-row ">
                  <div class="main1 flex-col">
                    <span class="word5">生产订单数</span>
                  </div>
                  <div class="main2 flex-col">
                    <span class="txt1">超期异常</span>
                  </div>
                </div>
                <div class="group9 flex-row justify-center">
                  <span class="word1">{{list[2].lingliao||0}}</span>
                  <span class="info3">{{list[2].bufenlingliao||0}}</span>
                </div>
                <div class="group10 flex-row">
                  <div class="layer2 flex-col">
                    <span class="info5">APS排产中</span>
                  </div>
                  <div class="layer3 flex-col">
                    <span class="txt2">异常未排产</span>
                  </div>
                </div>
                <div class="group11 flex-row justify-center">
                  <span class="info50">{{list[2].PlanQty}}</span>
                  <span class="word3">{{list[2].HasQty}}</span>
                </div>
                <div class="group12 flex-row">
                  <div class="mod2 flex-col">
                    <span class="word4">日计划订单数</span>
                  </div>
                  <div class="mod3 flex-col">
                    <span class="info6">已完成</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="main45 flex-col">
              <div class="bd34 flex-row justify-start">
                <span class="word76">超期订单明细</span>
              </div>
              <div class="main3 flex-row  justify-between">
                <span class="word tableWidthRatio8">类型</span>
                <span class="word tableWidthRatio10">订单号</span>
                <span class="word tableWidthRatio26">产品编码</span>
                <span class="word tableWidthRatio7">型号</span>
                <span class="word tableWidthRatio7">数量</span>
                <span class="word tableWidthRatio7">来源单号</span>
                <span class="word tableWidthRatio7">计划交期</span>
                <span class="word tableWidthRatio7">超期天数</span>
                <span class="word tableWidthRatio7">超期原因</span>
                <!-- <span class="word tableWidthRatio7">T6</span>
                <span class="word tableWidthRatio7">T7</span> -->
              </div>
              <div class="table1 wrap">
                <div >
                  <div  class=" text-wrapper flex-row justify-between" v-for="(item,index) in list[3]" :key="index"> 
                    <span class="tableWidthRatio8 tableContent">{{item.LineName}}</span>
                    <span class="tableWidthRatio10 tableContent">{{item.OrderNo}}</span>
                    <span class="tableWidthRatio26 tableContent">{{item.Code}}</span>
                    <span class="tableWidthRatio7 tableContent">{{item.Qty}}</span>
                    <span class="tableWidthRatio7 tableContent">{{item.day1}}</span>
                    <span class="tableWidthRatio7 tableContent">{{item.day2}}</span>
                    <span class="tableWidthRatio7 tableContent">{{item.day3}}</span>
                    <span class="tableWidthRatio7 tableContent">{{item.day4}}</span>
                    <span class="tableWidthRatio7 tableContent">{{item.day5}}</span>
                    <!-- <span class="tableWidthRatio7 tableContent">{{item.day6}}</span>
                    <span class="tableWidthRatio7 tableContent">{{item.day7}}</span> -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="group46 flex-row justify-between">
            <div class="outer27 flex-col">
              <div class=" flex-col">
                <span class="word77">周计划达成</span>
              </div>
              <div class="navboxall" id="WeeksRateOption"></div>
            </div>
            <div class="outer28 flex-col">
              <div class="group47 flex-row">
                <span class="word78">近15日产量趋势</span>
              </div>
              <div class="navboxall" id="RealTimeProOption"></div>
            </div>
            <div class="outer29 flex-col">
              <div class="block58 flex-row">
                <span class="txt44">周齐套率</span>
              </div>
              <div class="navboxall" id="OrderCapOption"></div>
            </div>
          </div>

          <div class="group48 flex-row justify-between">
            <div class="bd36 flex-col">
              <div class="outer26 flex-row">
                <span class="info34">生产计划吻合度</span>
              </div>
              <div class="content flex-col justify-between">
                <div class="navboxall3" id="weeksBadOption"></div>
                <div class="mod">
                  <div class="mod12 flex-row justify-between">
                    <span class="word62">{{list[7].PlanQty}}</span>
                    <span class="word63">{{list[7].BadQty}}</span>
                  </div>
                  <div class="mod13 flex-row justify-between">
                    <span class="info26">计划数</span>
                    <span class="word64">不良数</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="bd36 flex-col">
              <div class="outer26 flex-row">
                <span class="info34">日计划达成率</span>
              </div>
              <div class="content flex-col justify-between">
                <div class="navboxall3" id="weeksFinishOption"></div>
                <div class="mod">
                  <div class="mod12 flex-row justify-between">
                    <span class="txt37">{{list[8].PlanQty}}</span>
                    <span class="word65">{{list[8].HasQty}}</span>
                  </div>
                  <div class="mod13 flex-row justify-between">
                    <span class="word66">计划数</span>
                    <span class="txt38">完成数</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="bd36 flex-col">
              <div class="outer26 flex-row">
                <span class="info34">不达成原因分布</span>
              </div>
              <div class="content1 flex-col justify-between">
                <div class="navboxall2" id="WeeksBadQtyOption"></div>
              </div>
            </div>
            <div class="bd36 flex-col">
              <div class="outer26 flex-row">
                <span class="info34">欠料类型分布</span>
              </div>
              <div class="content1 flex-col justify-between">
                <div class="navboxall2" id="WeeksUnfinishOption"></div>
              </div>
            </div>
            <div class="bd36 flex-col">
              <div class="outer26 flex-row">
                <span class="info34">欠料属性分布</span>
              </div>
              <div class="content1 flex-col justify-between">
                <div class="navboxall2" id="WeeksOweMatOption"></div>
              </div>
            </div>
            <div class="group49 flex-col">
              <div class="bd34 flex-row justify-start">
                <span class="txt46">电机供需分析</span>
              </div>
              <div class="main3 flex-row  justify-between">
                <span class="word tableWidthRatio20">工单号</span>
                <span class="word tableWidthRatio50">电机料号</span>
                <span class="word tableWidthRatio15">电机库存</span>
                <!-- <span class="word tableWidthRatio15">欠料数</span> -->
              </div>
              <div class="table1 wrap">
                <div>
                  <div class="text-wrapper flex-row justify-between" v-for="(item,index) in list[12]" :key="index">
                    <span class="tableWidthRatio20 tableContent">{{item.OrderNo}}</span>
                    <span class="tableWidthRatio50 tableContent">{{item.Code}}</span>
                    <span class="tableWidthRatio15 tableContent">{{item.PlanQty}}</span>
                    <!-- <span class="tableWidthRatio15 tableContent">{{item.Qty}}</span> -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
<script src="./js/vue.js" type="text/javascript"></script>
<script src="./js/axios.min.js" type="text/javascript"></script>
<script src="./js/token.js?ver=5" type="text/javascript"></script>
<script src="./js/jquery-1.11.0.min.js" type="text/javascript"></script>
<script type="text/javascript" src="./js/jquery.limarquee.js"></script>
<script type="text/javascript" src="./js/echarts.min.js"></script>
<script>
  // 监听窗口大小改变
  let resizeTimer = null;
  let htmlHeight = ($('.wrap1').css('height')).slice(0, -2)-40
  let pageHeight = ($('.page').css('height')).slice(0, -2)
  let contentHeight = ''
  let mainHeight = htmlHeight - ($('.group43').css('height')).slice(0, -2)
  // 下面主体显示内容高度
  $('.mainContent').height(mainHeight)

  $(window).resize(function () {
    if (resizeTimer) {
      clearTimeout(resizeTimer);
    }
    resizeTimer = setTimeout(function () {
      htmlHeight = ($('.wrap1').css('height')).slice(0, -2)-40
      mainHeight = htmlHeight - ($('.group43').css('height')).slice(0, -2)
      $('.mainContent').height(mainHeight)

      //图表
      echarts.init(document.getElementById('PerHourCapOption')).resize()
      echarts.init(document.getElementById('WeeksRateOption')).resize()
      echarts.init(document.getElementById('OrderCapOption')).resize()
      echarts.init(document.getElementById('RealTimeProOption')).resize()
      echarts.init(document.getElementById('weeksBadOption')).resize()
      echarts.init(document.getElementById('weeksFinishOption')).resize()
      echarts.init(document.getElementById('WeeksBadQtyOption')).resize()
      echarts.init(document.getElementById('WeeksUnfinishOption')).resize()
      echarts.init(document.getElementById('WeeksOweMatOption')).resize()
    }, 100)
  })

</script>
<script type="module">
  import formatDate from './js/newFormatDate.js'
  var app = new Vue({
    el: "#app",
    components: {
    },
    data() {
      return {
        OrganizeIDsList:[],
        form:{},
        OrganizeIDs:'',
        large: true,
        list: [[], [], [], [], [], [], [], [], [], [], [], [], []],
        time: null,
        todayDate: '',
        PerHourCapOption: {
          tooltip: {
            trigger: 'axis',
            axisPointer: {
              type: 'shadow'
            }
          },
          grid: {
            left: '0%',
            right: '10%',
            bottom: '-8%',
            top: '0%',
            containLabel: true//自适应画布大小
          },
          barMaxWidth:30,
          xAxis: {
            type: 'value',
            // boundaryGap: [0, 0.01],
            axisLine: {
              show: false,
              lineStyle: {
                color: '#fff',//x轴线颜色
              }
            },
            show: false
          },
          yAxis: {
            type: 'category',//柱状图横置
            data: [],
            axisLine: {
              show: false,//去除坐标轴线
              lineStyle: {
                color: '#fff',//y轴线颜色
              }
            },
            // 去除刻度线
            axisTick: {
              show: false
            },
          },
          series: [
            {
              label: {
                show: true,
                position: 'right',
                color: '#fff'
              },
              type: 'bar',
              data: [],
              color: [new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                { offset: 0, color: "#FFD43E" },
                { offset: 0.1, color: "#FFDE67" },
                { offset: 1, color: "#28FFFF" },
              ]),
              ],
              // 柱形图圆角
              itemStyle: {
                emphasis: {
                  barBorderRadius: 3
                },
                normal: {
                  barBorderRadius: 3
                }
              }
            },
          ]
        },
        // color: null,
        CubeLeft: new echarts.graphic.extendShape({
          shape: {
            x: 0,
            y: 0,
          },
          buildPath: function (ctx, shape) {
            const xAxisPoint = shape.xAxisPoint;
            const c0 = [shape.x + (-13), shape.y];
            const c1 = [shape.x - 5 + (-13), shape.y - 5];
            const c2 = [xAxisPoint[0] - 5 + (-13), xAxisPoint[1] - 5];
            const c3 = [xAxisPoint[0] + (-13), xAxisPoint[1]];
            ctx
              .moveTo(c0[0], c0[1])
              .lineTo(c1[0], c1[1])
              .lineTo(c2[0], c2[1])
              .lineTo(c3[0], c3[1])
              .closePath();
          },
        }),
        CubeRight: echarts.graphic.extendShape({
          shape: {
            x: 0,
            y: 0,
          },
          buildPath: function (ctx, shape) {
            const xAxisPoint = shape.xAxisPoint;
            const c1 = [shape.x + (-13), shape.y];
            const c2 = [xAxisPoint[0] + (-13), xAxisPoint[1]];
            const c3 = [xAxisPoint[0] + 18 + (-13), xAxisPoint[1] - 0];
            const c4 = [shape.x + 18 + (-13), shape.y - 0];
            ctx
              .moveTo(c1[0], c1[1])
              .lineTo(c2[0], c2[1])
              .lineTo(c3[0], c3[1])
              .lineTo(c4[0], c4[1])
              .closePath();
          },
        }),
        CubeTop: echarts.graphic.extendShape({
          shape: {
            x: 0,
            y: 0,
          },
          buildPath: function (ctx, shape) {
            const c1 = [shape.x + (-13), shape.y];
            const c2 = [shape.x + 18 + (-13), shape.y - 0];
            const c3 = [shape.x + 15 + (-13), shape.y - 5];
            const c4 = [shape.x - 5 + (-13), shape.y - 5];
            ctx
              .moveTo(c1[0], c1[1])
              .lineTo(c2[0], c2[1])
              .lineTo(c3[0], c3[1])
              .lineTo(c4[0], c4[1])
              .closePath();
          },
        }),
        CubeLeft1: new echarts.graphic.extendShape({
          shape: {
            x: 0,
            y: 0,
          },
          buildPath: function (ctx, shape) {
            const xAxisPoint = shape.xAxisPoint;
            const c0 = [shape.x - (-13), shape.y];
            const c1 = [shape.x - 5 - (-13), shape.y - 5];
            const c2 = [xAxisPoint[0] - 5 - (-13), xAxisPoint[1] - 5];
            const c3 = [xAxisPoint[0] - (-13), xAxisPoint[1]];
            ctx
              .moveTo(c0[0], c0[1])
              .lineTo(c1[0], c1[1])
              .lineTo(c2[0], c2[1])
              .lineTo(c3[0], c3[1])
              .closePath();
          },
        }),
        CubeRight1: echarts.graphic.extendShape({
          shape: {
            x: 0,
            y: 0,
          },
          buildPath: function (ctx, shape) {
            const xAxisPoint = shape.xAxisPoint;
            const c1 = [shape.x - (-13), shape.y];
            const c2 = [xAxisPoint[0] - (-13), xAxisPoint[1]];
            const c3 = [xAxisPoint[0] + 18 - (-13), xAxisPoint[1] - 0];
            const c4 = [shape.x + 18 - (-13), shape.y - 0];
            ctx
              .moveTo(c1[0], c1[1])
              .lineTo(c2[0], c2[1])
              .lineTo(c3[0], c3[1])
              .lineTo(c4[0], c4[1])
              .closePath();
          },
        }),
        CubeTop1: echarts.graphic.extendShape({
          shape: {
            x: 0,
            y: 0,
          },
          buildPath: function (ctx, shape) {
            const c1 = [shape.x - (-13), shape.y];
            const c2 = [shape.x + 18 - (-13), shape.y - 0];
            const c3 = [shape.x + 15 - (-13), shape.y - 5];
            const c4 = [shape.x - 5 - (-13), shape.y - 5];
            ctx
              .moveTo(c1[0], c1[1])
              .lineTo(c2[0], c2[1])
              .lineTo(c3[0], c3[1])
              .lineTo(c4[0], c4[1])
              .closePath();
          },
        }),
        WeeksRateOption: {
          color: ["#FFDF9C", "#73FCFF", "#17DB94"],
          grid: {
            left: '2%',
            right: '2%',
            bottom: 0,
            top: '25%',
            containLabel: true,
          },
          // 鼠标移上去显示问题提示
          tooltip: {
            trigger: 'axis',
            axisPointer: {
              type: 'shadow'
            }
          },
          legend: {
            data: [
              {
                name: "计划量",
              },
              {
                name: "完成量",
              },
              {
                name: "配套率",
              },
            ],
            textStyle: {//图例文字颜色
              color: "#fff",
            },
            top: "5%",
          },
          xAxis: {
            type: "category",
            data: [],
            axisLine: {
              show: true,
              lineStyle: {
                color: '#fff',//x轴线颜色
              },
            },
            axisTick: {
              show: false,//是否显示刻度线
              lineStyle: {//刻度样式
                color: "#fff",
              },
            },
            axisLabel: {//是否显示刻度标签
              color: "#fff",
            },
            axisLine: {
              show: true,//是否显示坐标轴轴线

            },
          },
          yAxis: [
            {
              type: "value",
              axisLine: {
                show: false,//是否显示坐标轴轴线
              },
              splitLine: {
                show: false,//是否显示分隔线
              },
              axisTick: {
                show: false,//是否显示坐标轴刻度
              },
              axisLabel: {
                show: false,//是否显示刻度标签
              },
              min: 0,
            },
            {
              type: "value",
              axisLine: {
                show: false,//是否显示坐标轴轴线
              },
              splitLine: {
                show: false,//是否显示分隔线
              },
              axisTick: {
                show: false,//是否显示坐标轴刻度
              },
              axisLabel: {
                show: false,//是否显示刻度标签
              },
              min: 0,
            },
          ],
          series: [
            {

              label: {
                show: true,
                position: 'top',
                color: '#fff',
                formatter: function (value) {
                  return value.value + '%';
                },
              },
              name: "配套率",
              type: "line",
              symbolSize: 10,
              symbol: "circle",
              lineStyle: {
                color: "#17DB94",
              },
              itemStyle: {
                color: "#fff",
                borderColor: "#17DB94",
                borderWidth: 2,
                barBorderRadius: 0,
                label: {
                  formatter: function (p) {
                    return p.value > 0 ? (p.value) + '%' : "";
                  },
                },
              },
              tooltip: {
                trigger: 'axis',
                valueFormatter: function (value) {
                  console.log('格式化百分比', value)
                  return value + '%';
                },
              },
              data: [],
              yAxisIndex: 1,//y轴图例下标
            },
            {
              label: {
                normal: {
                  show: true,
                  position: "top",
                  fontSize: 11,
                  color: "rgba(103, 123, 145, 1)",
                  offset: [5, -15],
                },
              },
              type: "custom",
              name: "计划量",
              renderItem: (params, api) => {
                const location = api.coord([api.value(0), api.value(1)]);
                return {
                  type: "group",
                  children: [
                    {
                      type: "CubeLeft",
                      shape: {
                        api,
                        xValue: api.value(0),
                        yValue: api.value(1),
                        x: location[0],
                        y: location[1],
                        xAxisPoint: api.coord([api.value(0), 0]),
                      },
                      style: {
                        fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                          {
                            offset: 0,
                            color: "#FFD680",
                          },
                          {
                            offset: 1,
                            color: "#FFD680",
                          },
                        ]),
                      },
                      textConfig: {
                        position: 'top'
                      }
                    },
                    {
                      type: "CubeRight",
                      shape: {
                        api,
                        xValue: api.value(0),
                        yValue: api.value(1),
                        x: location[0],
                        y: location[1],
                        xAxisPoint: api.coord([api.value(0), 0]),
                      },
                      style: {
                        fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                          {
                            offset: 0,
                            color: "#F1C054",
                          },
                          {
                            offset: 1,
                            color: "#F1C054",
                          },
                        ]),
                      },
                    },
                    {
                      type: "CubeTop",
                      shape: {
                        api,
                        xValue: api.value(0),
                        yValue: api.value(1),
                        x: location[0],
                        y: location[1],
                        xAxisPoint: api.coord([api.value(0), 0]),
                      },
                      style: {
                        fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                          {
                            offset: 0,
                            color: "#FFDF9C",
                          },
                          {
                            offset: 1,
                            color: "#FFDF9C",
                          },
                        ]),
                      },
                    },
                  ],
                };
              },
              data: [],
            },
            {
              label: {
                normal: {
                  show: true,
                  position: "top",
                  fontSize: 11,
                  color: "rgba(103, 123, 145, 1)",
                  offset: [5, -15],
                },
              },
              type: "custom",
              name: "完成量",
              renderItem: (params, api) => {
                const location = api.coord([api.value(0), api.value(1)]);
                var style = api.style();
                return {
                  type: "group",
                  children: [
                    {

                      type: "CubeLeft1",
                      shape: {
                        api,
                        xValue: api.value(0),
                        yValue: api.value(1),
                        x: location[0],
                        y: location[1],
                        xAxisPoint: api.coord([api.value(0), 0]),
                      },
                      style: {
                        fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                          {
                            offset: 0,
                            color: "#7BF6F9",
                          },
                          {
                            offset: 1,
                            color: "#7BF6F9",
                          },
                        ]),
                      },
                    },
                    {
                      type: "CubeRight1",
                      shape: {
                        api,
                        xValue: api.value(0),
                        yValue: api.value(1),
                        x: location[0],
                        y: location[1],
                        xAxisPoint: api.coord([api.value(0), 0]),
                      },
                      style: {
                        fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                          {
                            offset: 0,
                            color: "#4CCFD1",
                          },
                          {
                            offset: 1,
                            color: "#4CCFD1",
                          },
                        ]),
                      },
                    },
                    {
                      type: "CubeTop1",
                      shape: {
                        api,
                        xValue: api.value(0),
                        yValue: api.value(1),
                        x: location[0],
                        y: location[1],
                        xAxisPoint: api.coord([api.value(0), 0]),
                      },
                      style: {
                        fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                          {
                            offset: 0,
                            color: "#73FCFF",
                          },
                          {
                            offset: 1,
                            color: "#73FCFF",
                          },
                        ]),
                      },
                    },
                  ],
                };
              },
              data: [],
            },

          ],
        },
        RealTimeProOption: {
          tooltip: {
            trigger: 'axis',
            axisPointer: {
              type: 'cross',
              label: {
                backgroundColor: '#999'
              }
            }
          },
          legend: {
            textStyle: {
              color: '#fff',//图例文本颜色
            },
          },
          grid: {
            left: '2%',
            right: '5%',
            bottom: 0,
            top: '20%',
            containLabel: true,
          },
          xAxis: [
            {
              type: 'category',
              boundaryGap: false,
              axisPointer: {
                type: 'shadow'
              },
              axisLine: {
                show: true,
                lineStyle: {
                  color: '#fff',//x轴线颜色
                }
              },
              axisLabel:{
                interval: 0//坐标轴过多自动隐藏时，此项可以显示全

              },
              data: []
            }
          ],
          yAxis: [
            {
              show: true,
              name: '(单位：台)',
              type: 'value',
              axisLine: {
                show: true,
                lineStyle: {
                  color: '#fff',//y轴线颜色
                }
              },
              splitLine: {
                show: false,//是否显示分隔线
              },
            },
          ],
          series: [
            {
              label: {
                show: true,
                position: 'top',
                color:'#1EE1FF'
              },
              // avoidLabelOverlap:true,
              name: '工序1',
              type: 'line',
              areaStyle: {},
              emphasis: {
                focus: 'series'
              },
              itemStyle: {
                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                  { offset: 0, color: '#1EE1FF' },
                  { offset: 1, color: 'rgba(30,225,255,0)' }
                ]),
              },
              data: []
            },
            {
              label: {
                show: true,
                position: 'top',
              },
              name: '工序2',
              type: 'line',
              emphasis: {
                focus: 'series'
              },
              itemStyle: {
                color: '#F5CC3F'
              },
              data: []
            },
            {
              name: '工序3',
              type: 'line',
              label: {
                show: true,
                position: 'top'
              },
              emphasis: {
                focus: 'series'
              },
              itemStyle: {
                color: '#71C64C'
              },
              data: []
            }
          ]
        },
        OrderCapOption: {
          // 提示框
          tooltip: {
            trigger: 'axis',//坐标轴触发
            axisPointer: {//坐标轴指示器配置项
              type: 'cross',
              crossStyle: {
                color: '#999',
              },
              // 坐标轴指示器的文本标签样式
              label: {
                backgroundColor: '#999'
              }
            },
          },
          // 工具栏
          toolbox: {
            feature: {
            }
          },
          //图例组件
          legend: {
            data: ['工单数', '齐套数', '齐套率'],
            textStyle: {
              color: '#fff',//图例文本颜色
            },
          },
          grid: {
            left: '0%',
            right: '0%',
            bottom: '0%',
            top: '15%',
            containLabel: true,//是否包含刻度标签
          },
          xAxis: [
            {
              type: 'category',
              data: [],
              axisPointer: {
                type: 'shadow'
              },
              axisLine: {
                show: true,
                lineStyle: {
                  color: '#fff',//x轴线颜色
                }
              },
            }
          ],
          yAxis: [
            {
              show: false,
              type: 'value',
              name: '（单位：台）',
              axisLine: {
                show: false,
                lineStyle: {
                  color: '#fff',//y轴线颜色
                }
              }
            },
            {
              show: false,
              type: 'value',
              min: 0,
              axisLine: {
                show: true,
                lineStyle: {
                  color: '#fff',
                }
              }
            }
          ],
          series: [
            {
              label: {
                show: true,
                position: 'top',
                color: '#fff'
              },
              name: '工单数',// 写这个开启图例时会显示
              type: 'bar',
              barWidth: '25%',
              itemStyle: {
                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                  { offset: 0, color: '#7BF6F9' },
                  { offset: 1, color: '#0386FF' }
                ])
              },
              tooltip: {
                valueFormatter: function (value) {
                  return value;
                }
              },
              data: []
            },
            {
              label: {
                show: true,
                position: 'top',
                color: '#fff'
              },
              name: '齐套数',
              type: 'bar',
              barWidth: '25%',
              itemStyle: {
                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                  { offset: 0, color: '#FFD680' },
                  { offset: 1, color: '#FF8368' }
                ])
              },
              tooltip: {
                valueFormatter: function (value) {
                  return value;
                }
              },
              data: []
            },
            {
              label: {
                show: true,
                position: 'top',
                color: '#28FFFF',
                formatter: function (value) {
                  return value.value + '%';
                },
              },
              name: '齐套率',
              type: 'line',
              yAxisIndex: 1,
              tooltip: {
                trigger: 'axis',
                valueFormatter: function (value) {
                  return value + '%';
                },
              },
              itemStyle: {
                color: '#28FFFF'
              },
              data: []
            }
          ]
        },
        weeksBadOption: {
          title: {
            text: "不良率\n99%",
            x: "center",
            y: "54%",
            textStyle: {
              fontSize: 12,
              color: '#FFD43E',
            },
          },
          // grid: {
          //   left: '0%',
          //   right: '0%',
          //   bottom: '50%',
          //   top: '50%',
          //   containLabel: true,//是否包含刻度标签
          // },
          // tooltip: {},
          series: [
            {
              color: ["#33ccff", "#3399ff", "rgba(0,0,0,0)"],
              name: "",
              type: "pie",
              hoverAnimation: false,
              startAngle: -180,
              radius: ["45%", "85%"],
              center: ["50%", "70%"],
              label: {
                normal: {
                  show: false,
                  position: "inner", //显示在扇形上
                  formatter: "{b}", //显示内容
                  textStyle: {
                    color: "white", // 改变标示文字的颜色
                    fontSize: 12, //文字大小
                    fontWeight: "bold",
                  },
                },
              },
              labelLine: {
                normal: {
                  show: false,
                },
              },
              data: [
                {
                  name: "计划数",
                  value: "",
                  itemStyle: {
                    color: '#10D38C',
                    emphasis: {
                    },
                  },

                },
                {
                  name: "不良数",
                  value: "",
                  itemStyle: {
                    color: '#EB9288',
                    emphasis: {
                    },
                  },
                },
                {
                  name: "__other",
                  value: "",
                  itemStyle: {
                    color: 'rgba(0,0,0,0)',
                    emphasis: {
                    },
                  },
                },
              ],
            },
            {
              name: "",
              type: "pie",
              hoverAnimation: false,
              startAngle: -180,
              radius: ["85%", "100%"],
              center: ["50%", "70%"],
              label: {
                normal: {
                  show: false,
                  position: "inner", //显示在扇形上
                  formatter: "{b}", //显示内容
                  textStyle: {
                    color: "white", // 改变标示文字的颜色
                    fontSize: 12, //文字大小
                    fontWeight: "bold",
                  },
                },
              },
              labelLine: {
                normal: {
                  show: false,
                },
              },
              data: [
                {
                  name: "计划数",
                  value: '',
                  itemStyle: {
                    color: '#07686B',
                    emphasis: {
                    },
                  },

                },
                {
                  name: "不良数",
                  value: '',
                  itemStyle: {
                    color: '#76496B',
                    emphasis: {
                    },
                  },
                },
                {
                  name: "__other",
                  value: '',
                  itemStyle: {
                    color: 'rgba(0,0,0,0)',
                    emphasis: {
                    },
                  },
                },
              ],
            },
          ],
        },
        weeksFinishOption: {
          title: {
            text:'',
            x: "center",
            y: "54%",
            textStyle: {
              fontSize: 12,
              color: '#FFD43E',
            },
          },
          // {a}：系列名
          // {b}：数据名
          // {c}：数据值
          // {d}：百分比
          // tooltip: {},
          series: [
            {
              color: ["#33ccff", "#3399ff", "rgba(0,0,0,0)"],
              name: "",
              type: "pie",
              hoverAnimation: false,
              startAngle: -180,
              radius: ["45%", "85%"],
              center: ["50%", "70%"],
              label: {
                normal: {
                  show: false,
                  position: "inner", //显示在扇形上
                  formatter: "{b}", //显示内容
                  textStyle: {
                    color: "white", // 改变标示文字的颜色
                    fontSize: 12, //文字大小
                    fontWeight: "bold",
                  },
                },
              },
              labelLine: {
                normal: {
                  show: false,
                },
              },
              data: [
                {
                  name: "计划数",
                  value: "",
                  itemStyle: {
                    color: '#57BDFD',
                    emphasis: {
                    },
                  },
                },
                {
                  name: "完成数",
                  value: "",
                  itemStyle: {
                    color: '#FEC479',
                    emphasis: {
                    },
                  },
                },
                {
                  name: "__other",
                  value: "",
                  itemStyle: {
                    color: 'rgba(0,0,0,0)',
                    emphasis: {
                    },
                  },
                },
              ],
            },
            {
              name: "",
              type: "pie",
              hoverAnimation: false,
              startAngle: -180,
              radius: ["85%", "100%"],
              center: ["50%", "70%"],
              label: {
                normal: {
                  show: false,
                  position: "inner", //显示在扇形上
                  formatter: "{b}", //显示内容
                  textStyle: {
                    color: "white", // 改变标示文字的颜色
                    fontSize: 12, //文字大小
                    fontWeight: "bold",
                  },
                },
              },
              labelLine: {
                normal: {
                  show: false,
                },
              },
              data: [
                {
                  name: "计划数",
                  value: "",
                  itemStyle: {
                    color: '#2D63A6',
                    emphasis: {
                    },
                  },
                },
                {
                  name: "完成数",
                  value: "",
                  itemStyle: {
                    color: '#806161',
                    emphasis: {
                    },
                  },
                },
                {
                  name: "__other",
                  value: "",
                  itemStyle: {
                    color: 'rgba(0,0,0,0)',
                    emphasis: {
                    },
                  },
                },
              ],
            },
          ],
        },
        
        WeeksBadQtyOption: {
          color: [
            '#1ADE97',
            '#2290F6',
            '#F6BB22',
            '#EB8888',
            "#0CD2E6",
            "#3751E6",
            "#FFC722",
            "#886EFF",
            "#008DEC",
            "#114C90",
            "#00BFA5",
          ],
          title: {
            text: "",
            x: "center",
            y: "43%",
            textStyle: {
              // fontSize: 16,
              color: '#fff',
            },
          },
          // 鼠标移上去显示问题提示
          tooltip: {
            trigger: 'item',
            confine: true//将此限制打开后tooltip将不再溢出
          },
          series: [
            {
              name: "",
              type: "pie",
              radius: ["40%", "50%"],
              center: ["50%", "50%"],
              data: [],
              labelLine: {
                length: 10,
                length2: 30,
                rotate:60,
              },
              minAngle: 45,
              left: '10%',
              right: '10%',
              bottom: '0%',
              top: '0%',
              label: {
                position: "outer",
                alignTo: "none",
                bleedMargin: 5,
                formatter: "{a|{c}} {b|{d}%} \n {b}",
                padding: -40,
                rich: {
                  a: {
                    color: "#fff",
                    lineHeight: 20,
                  },
                  b: {
                    lineHeight: 20,
                  },
                },
              },
            },
          ],
        },
        WeeksUnfinishOption: {
          color: [
            '#1ADE97',
            '#2290F6',
            '#F6BB22',
            '#EB8888',
            "#0CD2E6",
            "#3751E6",
            "#FFC722",
            "#886EFF",
            "#008DEC",
            "#114C90",
            "#00BFA5",
          ],
          title: {
            text: "",
            x: "center",
            y: "43%",
            textStyle: {
              // fontSize: 16,
              color: '#fff',
            },
          },
          // 鼠标移上去显示问题提示
          tooltip: {
            trigger: 'item',
            confine: true//将此限制打开后tooltip将不再溢出
          },
          series: [
            {
              name: "",
              type: "pie",
              radius: ["40%", "50%"],
              center: ["50%", "50%"],
              data: [],
              labelLine: {
                length: 10,
                length2: 30,
              },
              minAngle: 45,
              left: '10%',
              right: '10%',
              bottom: '0%',
              top: '0%',
              label: {
                position: "outer",
                alignTo: "none",
                bleedMargin: 5,
                formatter: "{a|{c}} {b|{d}%} \n {b}",
                padding: -40,
                rich: {
                  a: {
                    color: "#fff",
                    lineHeight: 20,
                  },
                  b: {
                    lineHeight: 20,
                  },
                },
              },
            },
          ],
        },
        WeeksOweMatOption: {
          color: [
            '#1ADE97',
            '#2290F6',
            '#F6BB22',
            '#EB8888',
            "#0CD2E6",
            "#3751E6",
            "#FFC722",
            "#886EFF",
            "#008DEC",
            "#114C90",
            "#00BFA5",
          ],
          title: {
            text: "",
            x: "center",
            y: "43%",
            textStyle: {
              // fontSize: 16,
              color: '#fff',
            },
          },
          // 鼠标移上去显示问题提示
          tooltip: {
            trigger: 'item',
            confine: true//将此限制打开后tooltip将不再溢出
          },
          series: [
            {
              name: "",
              type: "pie",
              radius: ["40%", "50%"],
              center: ["50%", "50%"],
              data: [],
              labelLine: {
                length: 10,
                length2: 30,
              },
              minAngle: 45,
              left: '10%',
              right: '10%',
              bottom: '0%',
              top: '0%',
              label: {
                position: "outer",
                alignTo: "none",
                bleedMargin: 5,
                formatter: "{a|{c}} {b|{d}%} \n {b}",
                padding: -40,
                rich: {
                  a: {
                    color: "#fff",
                    lineHeight: 20,
                  },
                  b: {
                    lineHeight: 20,
                  },
                },
              },
            },
          ],
        },

      }
    },
    created() {
      this.todayDate = formatDate.getTodayTime()
      if (this.time) {
        clearInterval(this.time)
      }
      this.time = setInterval(() => {
        this.todayDate = formatDate.getTodayTime()
      }, 1000)

      this.$nextTick(async()=>{
          let OrganizeIDs = this.getQueryString('ID')
          // 看板车间名称
          if(OrganizeIDs){
            await this.getOrgData(OrganizeIDs)
          }else{
            OrganizeIDs = 162//没有传入ID默认的ID
            await this.getOrgData(OrganizeIDs)
          }
          
      })
    },
    mounted() {
      
    },
    methods: {
      getOrgIDsData(OrganizeIDs){
        axiosPostRequst(`/APSAPI/APSData`, { dicID: 3026,OrganizeIDs })
            .then(async(res) =>{
              if (res.result) {
                  if(res.data.length){
                   await this.handleTree(res.data)
                   await this.getWorkData()
                  //  console.log('res',arr)
                    console.log('OrganizeIDsList',this.OrganizeIDsList)
                  }
              }
            })
      },
      getWorkData(){
        let Ids = this.OrganizeIDsList.length?this.OrganizeIDsList.join(','):''
        axiosPostRequst(`/APSAPI/APSData`, { OrganizeID: Ids,dicID:97,WorkingDate: [formatDate.formatTodayDate(), formatDate.formatTodayDate()],groupby:'OrganizeName' })
            .then(async(res) =>{
              if (res.result) {
                  if(res.data.length){
                    // Peoples
                    console.log('res.data',res.data)
                  }
              }
            })
      },
      //树结构递归
    handleTree(data) {
      let total = 0
      return data.filter((item, index) => {
        item.title = item.OrganizeName
        item.id = item.OrganizeID
        item.expanded = true
        if (item.children && item.children.length) {
          item.children = this.handleTree(item.children)
        }else{
          total +=Number(item.TotalPeoples)
        }
        this.OrganizeIDsList.push(item.OrganizeID)
        console.log('total',total)
        return true
      })
    },
      // 接收路由传参
      getQueryString(name) {
          let reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
          let r = window.location.search.substr(1).match(reg);
          if (r != null) return decodeURIComponent(r[2]); return null;
        },
      // 获取组织名称
      getOrgData(OrganizeIDs) {
          axiosPostRequst(`/APSAPI/GetOrgData`, { dicID: 3026, OrganizeID: OrganizeIDs })
            .then(async(res) =>{
              if (res.result) {
                if (res.data.length != 0) {
                  _this.form = res.data[0];
                }
                if(_this.form.OrganizeID){
                  // 人员管理
                  await this.getPersonData(_this.form.OrganizeID)
                  // 人均小时产能
                  await this.getProcessCapData(_this.form.OrganizeID)
                  // 本月工单状态
                  await this.getOrderData(_this.form.OrganizeID)
                  // 七日包装计划
                  await this.getProPlanData(_this.form.OrganizeID)
                  // 周配套率
                  await this.getWeeksCapData(_this.form.OrganizeID)
                  // 15日实时产量
                  await this.getRealTimeProData(_this.form.OrganizeID)
                  // 各品类工单齐套率
                  await this.getOrderCapData(_this.form.OrganizeID)
                  // 周生产不良率
                  await this.getWeeksBadData(_this.form.OrganizeID)
                  // 周计划达成率
                  await this.getWeeksFinishData(_this.form.OrganizeID)
                  // 周不良分布
                  await this.getWeeksBadQtyData(_this.form.OrganizeID)
                  // 周不达成分布
                  await this.getWeeksUnfinishData(_this.form.OrganizeID)
                  // 欠料分布
                  await this.getOweMatData(_this.form.OrganizeID)
                  // 欠料明细
                  await this.getOweMatDetailsData(_this.form.OrganizeID)
                  await this.getOrgIDsData(_this.form.OrganizeID)
                  if(_this.gudtime){
                    clearTimeout(_this.gudtime)
                  }
                  _this.gudtime = setTimeout(() => {
                    _this.gundong()
                    $(".loading").fadeOut()
                  }, 1000);
                }
              }
              else {
                _this.$message({
                  message: res.msg,
                  type: 'error'
                });
              }
            })
            .catch(function (error) {

            });
        },
      // 渲染echart图
      barData(id, option) {
        let chartDom = document.getElementById(id);
        let myChart = null
        if (myChart) {
          echarts.dispose(myChart)
        }
        myChart = echarts.init(chartDom);
        myChart.resize()
        myChart.setOption(option)
        myChart.clear();
        myChart.setOption(option)
        console.log('111')
        var timer = setInterval(function() {
            clearInterval(timer);
            // 下面处理业务
            _this.barData(id,option)
        }, 1000*60*5)
      },
      //获取人员管理数据
      getPersonData(OrganizeID) {
        // axiosPostRequst(`/APSAPI/APSData`, { dicID: })
        //   .then(function (res) {

        //   })
        // this.list[0] = {
        //   TotalPeoples: 120,
        //   ProductionQty: 100,
        //   unProductionQty: 20,
        //   lizhi:0,
        //   ruzhi:0
        // }
      },
      // 获取超期异常原因
      getProcessCapData(OrganizeID){
        axiosPostRequst(`/APSAPI/APSData`, { dicID:7779,groupby:'AbnormalReason' })
          .then(function (res) {
          //   if(this.list[1].length){
          // this.list[1].map(item=>{
          //   this.PerHourCapOption.yAxis.data.push(item.processName)
          //   this.PerHourCapOption.series[0].data.push(item.Qty)
          // })
        // }
        // this.barData('PerHourCapOption', this.PerHourCapOption)
          })
        
        
      },
      timeFormat(date,num){
        let y = date.getFullYear(); //年
        let m = date.getMonth() + 1; //月
        let d = date.getDate(); //日
        if (num == 1){
          d = date.getDate();
        }
        m = m < 10 ? "0" + m :m;
        d = d < 10 ? "0" + d : d;
        return y + "-" + m + "-" + d;
      },
      // 获取本月工单状态
      getOrderData(OrganizeID){
        var date = new Date();
        var currentMonth = date.getMonth();
        var nextMonth = ++currentMonth;
        var nextMonthFirstDay = new Date(date.getFullYear(), nextMonth, 1);
        var oneDay = 1000 * 60 * 60 * 24;
        //获取当前月最后一天
        let EndDate = this.timeFormat(new Date(nextMonthFirstDay -oneDay),1);
        //设置一个月的某一天，数值（1 ~ 31）
        date.setDate(1);
        let StartDate = this.timeFormat(date, 0);
        // 获取订单数
        axiosPostRequst(`/APSAPI/APSData`, { dicID:5156, StartDate:StartDate,EndDate:EndDate,fields:'SUM(Qty) as Qty'})
          .then(function (res) {
            if (res.result) {
              _this.list[2].Qty = res.data&&res.data[0].Qty || 0
            }
          })
          // 超期异常
          axiosPostRequst(`/APSAPI/APSData`, { dicID:5156, StartDate:StartDate,EndDate:EndDate,groupby:'Extend4',fields:'SUM(Qty) as Qty, Extend4'})
          .then(function (res) {
            if (res.result) {
              // _this.list[2] = []
              
            }
          })
        
      },
      // 获取七日包装计划
      getProPlanData(OrganizeID){
        // axiosPostRequst(`/APSAPI/APSData`, { dicID: })
        //   .then(function (res) {

        //   })
        this.list[3] =[
        { LineName: '7B', OrderNo: 'MO027177', Code: '1.15.01.APC10-0-2H1-008', Qty: 4000, day1: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '7B', OrderNo: 'MO025985', Code: '1.15.01.APC10-0-2H1-008', Qty: 950, day1: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '7B', OrderNo: 'MO036011', Code: '2.01.01.01.AHB10-0-2', Qty: 815, day1: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '7A', OrderNo: 'MO035173', Code: '2.01.01.01.AHB10-0-2', Qty: 850, day1: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '7C', OrderNo: 'MO034753', Code: '2.01.01.01.APB15-3-1A(5Y/NR)', Qty: 2300, day1: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '7D', OrderNo: 'MO037220', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 1500, day1: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '7D', OrderNo: 'MO037341', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 1500, day1: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '7D', OrderNo: 'MO036286', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 300, day1: 10, day2: 20, day3: 30, day4: 40, day5: 50, day6: 60, day7: 70 },
          { LineName: '7D', OrderNo: 'MO036286', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 300, day1: 10, day2: 20, day3: 30, day4: 40, day5: 50, day6: 60, day7: 70 },
          { LineName: '7D', OrderNo: 'MO036286', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 300, day1: 10, day2: 20, day3: 30, day4: 40, day5: 50, day6: 60, day7: 70 },
          { LineName: '7D', OrderNo: 'MO036286', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 300, day1: 10, day2: 20, day3: 30, day4: 40, day5: 50, day6: 60, day7: 70 },
          { LineName: '7D', OrderNo: 'MO036286', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 300, day1: 10, day2: 20, day3: 30, day4: 40, day5: 50, day6: 60, day7: 70 },
          { LineName: '7D', OrderNo: 'MO036286', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 300, day1: 10, day2: 20, day3: 30, day4: 40, day5: 50, day6: 60, day7: 70 },
          { LineName: '7D', OrderNo: 'MO036286', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 300, day1: 10, day2: 20, day3: 30, day4: 40, day5: 50, day6: 60, day7: 70 },
        ]
        // this.$nextTick(()=>{
        //   this.gundong()
        // })
 
      },
      // 周配套率
      getWeeksCapData(OrganizeID){
        // axiosPostRequst(`/APSAPI/APSData`, { dicID: })
        //   .then(function (res) {

        //   })
        this.list[4] =[
          {week:'W1',PlanQty:815,HasQty:815,},
          {week:'W2',PlanQty:2300,HasQty:0},
          {week:'W3',PlanQty:2000,HasQty:1400},
          {week:'W4',PlanQty:1500,HasQty:1300},
          {week:'W5',PlanQty:300,HasQty:300},
        ]
        if(this.list[4].length){
          this.list[4].map(item=>{
            this.WeeksRateOption.xAxis.data.push(item.week)
            this.WeeksRateOption.series[0].data.push(item.HasQty?parseFloat(((item.HasQty/item.PlanQty)*100).toFixed(2)):0)
            this.WeeksRateOption.series[1].data.push(item.PlanQty)
            this.WeeksRateOption.series[2].data.push(item.HasQty)
          })
        }
      echarts.graphic.registerShape("CubeTop", this.CubeTop);
      echarts.graphic.registerShape("CubeLeft", this.CubeLeft);
      echarts.graphic.registerShape("CubeRight", this.CubeRight);
      
      echarts.graphic.registerShape("CubeTop1", this.CubeTop1);
      echarts.graphic.registerShape("CubeLeft1", this.CubeLeft1);
      echarts.graphic.registerShape("CubeRight1", this.CubeRight1);
      console.log('this.WeeksRateOption',this.WeeksRateOption)
      // setTimeout(() => {
        this.barData('WeeksRateOption', this.WeeksRateOption)
      // }, 100);
      },
      // 15日实时产量
      getRealTimeProData(OrganizeID){
        // axiosPostRequst(`/APSAPI/APSData`, { dicID: })
        //   .then(function (res) {

        //   })
        this.list[5] =[
          {day:'day1',Qty1:200,Qty2:300,Qty3:400,Qty4:300},
          {day:'day2',Qty1:400,Qty2:500,Qty3:600,Qty4:500},
          {day:'day3',Qty1:500,Qty2:600,Qty3:700,Qty4:600},
          {day:'day4',Qty1:400,Qty2:600,Qty3:700,Qty4:''},
          {day:'day5',Qty1:'',Qty2:'',Qty3:'',Qty4:''},
          {day:'day6',Qty1:'',Qty2:'',Qty3:'',Qty4:''},
          {day:'day7',Qty1:'',Qty2:'',Qty3:'',Qty4:''},
          {day:'day8',Qty1:'',Qty2:'',Qty3:'',Qty4:''},
          {day:'day9',Qty1:'',Qty2:'',Qty3:'',Qty4:''},
          {day:'day10',Qty1:'',Qty2:'',Qty3:'',Qty4:0},
          {day:'day11',Qty1:'',Qty2:'',Qty3:'',Qty4:0},
          {day:'day12',Qty1:'',Qty2:'',Qty3:'',Qty4:0},
          {day:'day13',Qty1:'',Qty2:'',Qty3:'',Qty4:0},
          {day:'day14',Qty1:'',Qty2:'',Qty3:'',Qty4:0},
          {day:'day15',Qty1:'',Qty2:'',Qty3:'',Qty4:0},
        ]
        if(this.list[5].length){
          this.list[5].map(item=>{
            console.log('item',item)
            this.RealTimeProOption.xAxis[0].data.push(item.day)
            this.RealTimeProOption.series[0].data.push(item.Qty1)
            this.RealTimeProOption.series[1].data.push(item.Qty2)
            this.RealTimeProOption.series[2].data.push(item.Qty3)
          })
        }
        this.barData('RealTimeProOption', this.RealTimeProOption)
      },
      // 各品类工单齐套率
      getOrderCapData(OrganizeID){
        // axiosPostRequst(`/APSAPI/APSData`, { dicID: })
        //   .then(function (res) {

        //   })
        this.list[6] =[
        { LineName: '7A', OrderNo: 'MO027177', Code: '1.15.01.APC10-0-2H1-008', Qty: 4000, HasQty: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '7B', OrderNo: 'MO025985', Code: '1.15.01.APC10-0-2H1-008', Qty: 950, HasQty: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '7C', OrderNo: 'MO036011', Code: '2.01.01.01.AHB10-0-2', Qty: 815, HasQty: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '7D', OrderNo: 'MO035173', Code: '2.01.01.01.AHB10-0-2', Qty: 850, HasQty: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '1A', OrderNo: 'MO034753', Code: '2.01.01.01.APB15-3-1A(5Y/NR)', Qty: 2300, HasQty: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '1B', OrderNo: 'MO037220', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 1500, HasQty: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '3A', OrderNo: 'MO037341', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 1500, HasQty: 100, day2: 200, day3: 300, day4: 400, day5: 500, day6: 600, day7: 700 },
          { LineName: '3B', OrderNo: 'MO036286', Code: '2.01.01.01.APB30-6-1A(5Y)', Qty: 300, HasQty: 10, day2: 20, day3: 30, day4: 40, day5: 50, day6: 60, day7: 70 },
        ]
        if(this.list[6].length){
          this.list[6].map(item=>{
            this.OrderCapOption.xAxis[0].data.unshift(item.LineName)
            this.OrderCapOption.series[0].data.unshift(item.Qty ? parseFloat(item.Qty.toFixed(2)) : 0)
            this.OrderCapOption.series[1].data.unshift(item.HasQty ? parseFloat(item.HasQty.toFixed(2)) : 0)
            this.OrderCapOption.series[2].data.unshift(item.HasQty ? parseFloat(((item.HasQty / item.Qty) * 100).toFixed(2)) : 0)
          })
        }
        
        this.barData('OrderCapOption', this.OrderCapOption)
      },
      // 周生产不良率
      getWeeksBadData(OrganizeID){
        // axiosPostRequst(`/APSAPI/APSData`, { dicID: })
        //   .then(function (res) {

        //   })
        this.list[7] = {PlanQty:1000,BadQty:100}
        this.weeksBadOption.series[0].data[0].value = this.list[7].PlanQty
        this.weeksBadOption.series[0].data[1].value = this.list[7].BadQty
        this.weeksBadOption.series[0].data[2].value = this.list[7].PlanQty + this.list[7].BadQty
        this.weeksBadOption.series[1].data[0].value = this.list[7].PlanQty
        this.weeksBadOption.series[1].data[1].value = this.list[7].BadQty
        this.weeksBadOption.series[1].data[2].value = this.list[7].PlanQty + this.list[7].BadQty
        this.weeksBadOption.title.text =  `不良率\n${this.list[7].BadQty&&this.list[7].PlanQty ? parseFloat(((this.list[7].BadQty / this.list[7].PlanQty) * 100).toFixed(2)) : 0}%`
        this.barData('weeksBadOption', this.weeksBadOption)
      },
      // 日计划达成率
      getWeeksFinishData(OrganizeID){
        axiosPostRequst(`/APSAPI/APSData`, { dicID: 6723,PlanDay:formatDate.formatTodayDate(),rows:1,sort:'PlanDay ASC',fields:'SUM(PlanQty) AS PlanQty,SUM(HasQty) as HasQty',groupby:'PlanDay', })
          .then(function (res) {
            if(res.result){
              _this.list[8] = []
              _this.list[8].PlanQty = res.data&&res.data[0].PlanQty||0
              _this.list[8].HasQty = res.data&&res.data[0].HasQty||0
              _this.list[2].PlanQty = res.data&&res.data[0].PlanQty||0
              _this.list[2].HasQty = res.data&&res.data[0].HasQty||0
            // this.list[8] = {PlanQty:1000,HasQty:100}
            _this.weeksFinishOption.series[0].data[0].value = _this.list[8].PlanQty
            _this.weeksFinishOption.series[0].data[1].value = _this.list[8].HasQty
            _this.weeksFinishOption.series[0].data[2].value = _this.list[8].PlanQty + _this.list[8].HasQty
            _this.weeksFinishOption.series[1].data[0].value = _this.list[8].PlanQty
            _this.weeksFinishOption.series[1].data[1].value = _this.list[8].HasQty
            _this.weeksFinishOption.series[1].data[2].value = _this.list[8].PlanQty + _this.list[8].HasQty
            _this.weeksFinishOption.title.text =  `完成率\n${_this.list[8].HasQty&&_this.list[8].PlanQty ? parseFloat(((_this.list[8].HasQty / _this.list[8].PlanQty) * 100).toFixed(2)) : 0}%`
        setTimeout(()=>{
          _this.barData('weeksFinishOption', _this.weeksFinishOption)
        },100)
        
            }
            
          })
        
      },
      // 周不良分布
      getWeeksBadQtyData(OrganizeID){
        // axiosPostRequst(`/APSAPI/APSData`, { dicID: })
        //   .then(function (res) {

        //   })
        this.list[9] = [
          {
            name: "A类型",
            value: 3000,
          },
          {
            name: "B类型",
            value: 1000,
          },
          {
            name: "C类型",
            value: 1500,
          },
          {
            name: "D类型",
            value: 2300,
          },
        ]
        const formatData = []
        let total = 0
        if(this.list[9].length){
          this.list[9].forEach(function (item, index) {
            total+=item.value
          formatData.push(
            {
              value: item.value,
              name: item.name,
            },
            // {
            //   value: 3,
            //   name: "",
            //   itemStyle: {
            //     normal: {
            //       label: {
            //         show: false,
            //       },
            //       labelLine: {
            //         show: false,
            //       },
            //       color: "rgba(0, 0, 0, 0)",
            //       borderColor: "rgba(0, 0, 0, 0)",
            //       borderWidth: 0,
            //     },
            //   },
            // }
          );
        });
        }
        this.WeeksBadQtyOption.title.text = `${total}\n计划数`
        this.WeeksBadQtyOption.series[0].data = formatData
        this.barData('WeeksBadQtyOption', this.WeeksBadQtyOption)

      },
      // 周不达成分布
      getWeeksUnfinishData(OrganizeID){
        // axiosPostRequst(`/APSAPI/APSData`, { dicID: })
        //   .then(function (res) {

        //   })
        this.list[10] = [
          {
            name: "A类型",
            value: 3000,
          },
          {
            name: "B类型",
            value: 1000,
          },
          {
            name: "C类型",
            value: 1000,
          },
          {
            name: "D类型",
            value: 2300,
          },
        ]
        const formatData = []
        let total = 0
        if(this.list[10].length){
          this.list[10].forEach(function (item, index) {
            total+=item.value
          formatData.push(
            {
              value: item.value,
              name: item.name,
            },
            // {
            //   value: 3,
            //   name: "",
            //   itemStyle: {
            //     normal: {
            //       label: {
            //         show: false,
            //       },
            //       labelLine: {
            //         show: false,
            //       },
            //       color: "rgba(0, 0, 0, 0)",
            //       borderColor: "rgba(0, 0, 0, 0)",
            //       borderWidth: 0,
            //     },
            //   },
            // }
          );
        });
        }
        this.WeeksUnfinishOption.title.text = `${total}\n计划数`
        this.WeeksUnfinishOption.series[0].data = formatData
        this.barData('WeeksUnfinishOption', this.WeeksUnfinishOption)
      },
      // 欠料分布
      getOweMatData(OrganizeID){
        // axiosPostRequst(`/APSAPI/APSData`, { dicID: })
        //   .then(function (res) {

        //   })
        this.list[11] = [
          {
            name: "A类型",
            value: 3000,
          },
          {
            name: "B类型",
            value: 1000,
          },
          {
            name: "C类型",
            value: 1500,
          },
          {
            name: "D类型",
            value: 2300,
          },
        ]
        const formatData = []
        let total = 0
        if(this.list[11].length){
          this.list[11].forEach(function (item, index) {
            total+=item.value
          formatData.push(
            {
              value: item.value,
              name: item.name,
            },
            // {
            //   value: 3,
            //   name: "",
            //   itemStyle: {
            //     normal: {
            //       label: {
            //         show: false,
            //       },
            //       labelLine: {
            //         show: false,
            //       },
            //       color: "rgba(0, 0, 0, 0)",
            //       borderColor: "rgba(0, 0, 0, 0)",
            //       borderWidth: 0,
            //     },
            //   },
            // }
          );
        });
        }
        this.WeeksOweMatOption.title.text = `${total}\n计划数`
        this.WeeksOweMatOption.series[0].data = formatData
        this.barData('WeeksOweMatOption', this.WeeksOweMatOption)
      },
      // 欠料明细
      getOweMatDetailsData(OrganizeID){
        // axiosPostRequst(`/APSAPI/APSData`, { dicID: })
        //   .then(function (res) {

        //   })
        this.list[12] = [
          { LineName: '7B', OrderNo: 'MO027177', Code: '1.15.01.APC10-0-2H1-008', PlanQty: 4000, Qty: 100 },
          { LineName: '7B', OrderNo: 'MO025985', Code: '1.15.01.APC10-0-2H1-008', PlanQty: 950, Qty: 100 },
          { LineName: '7B', OrderNo: 'MO036011', Code: '2.01.01.01.AHB10-0-2', PlanQty: 815, Qty: 100 },
          { LineName: '7A', OrderNo: 'MO035173', Code: '2.01.01.01.AHB10-0-2', PlanQty: 850, Qty: 100 },
          { LineName: '7C', OrderNo: 'MO034753', Code: '2.01.01.01.APB15-3-1A(5Y/NR)', PlanQty: 2300, Qty: 100 },
          { LineName: '7D', OrderNo: 'MO037220', Code: '2.01.01.01.APB30-6-1A(5Y)', PlanQty: 1500, Qty: 100 },
          { LineName: '7D', OrderNo: 'MO037341', Code: '2.01.01.01.APB30-6-1A(5Y)', PlanQty: 1500, Qty: 100 },
          { LineName: '7D', OrderNo: 'MO036286', Code: '2.01.01.01.APB30-6-1A(5Y)', PlanQty: 300, Qty: 10 },
        ]
        
      },
      // 滚动数据
      gundong() {
         $('.wrap').liMarquee({
            direction: 'up',//身上滚动 
            runshort: false,//内容不足时不滚动
            scrollamount: 20//速度
          });
         
        },
        moreLarge() {
          
          this.large = !this.large
          if (!this.large) {
            // this.fullScreen()
            if (document.documentElement.requestFullscreen) {
              document.documentElement.requestFullscreen()
            }
            if (document.documentElement.mozRequestFullScreen) {
              document.documentElement.mozRequestFullScreen()
  
            }
            if (document.documentElement.webkitRequestFullScreen) {
              document.documentElement.webkitRequestFullScreen()
            }
            if (document.documentElement.msRequestFullscreen) {
              document.documentElement.msRequestFullscreen()
            }
          } else {
            // this.exitFullScreen()
            if (document.webkitCancelFullScreen) {
              document.webkitCancelFullScreen()
            }
            if (document.mozCancelFullScreen) {
              document.mozCancelFullScreen()
            }
            if (document.exitFullscreen) {
              document.exitFullscreen()
            }
            if (document.msExitFullscreen) {
              document.msExitFullscreen()
            }
          }
        },
    }
  })
  const _this = app
</script>

</html>
<style lang="scss" scoped>
  [v-cloak] {
    /*比较大的段落，防止闪烁，看到花括号*/
    display: none;

  }

  .navboxall_time {
    height: calc(100% - 10px);
  }

  .navboxall {
    height: calc(100% - 30px);
  }

  .navboxall3 {
    height: calc(100% - 30px)
  }

  .navboxall2 {
    height: calc(100% - 10px)
  }
</style>